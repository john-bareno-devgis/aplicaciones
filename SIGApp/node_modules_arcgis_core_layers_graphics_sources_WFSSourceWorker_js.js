"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["node_modules_arcgis_core_layers_graphics_sources_WFSSourceWorker_js"],{

/***/ 71362:
/*!******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/graphics/sources/WFSSourceWorker.js ***!
  \******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ F)
/* harmony export */ });
/* harmony import */ var _home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../core/asyncUtils.js */ 11823);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Error.js */ 32995);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/Logger.js */ 28191);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ 30801);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../geometry/support/spatialReferenceUtils.js */ 53492);
/* harmony import */ var _featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../featureConversionUtils.js */ 50805);
/* harmony import */ var _data_FeatureStore_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../data/FeatureStore.js */ 92203);
/* harmony import */ var _data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../data/projectionSupport.js */ 19482);
/* harmony import */ var _data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../data/QueryEngine.js */ 59266);
/* harmony import */ var _geojson_geojson_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./geojson/geojson.js */ 70554);
/* harmony import */ var _support_sourceUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./support/sourceUtils.js */ 65210);
/* harmony import */ var _ogc_wfsUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../ogc/wfsUtils.js */ 23337);
/* harmony import */ var _support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../../support/FieldsIndex.js */ 19346);
/* harmony import */ var _time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../../../time/timeZoneUtils.js */ 92691);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/














class F {
  constructor() {
    this._queryEngine = null, this._customParameters = null;
  }
  destroy() {
    this._queryEngine?.destroy(), this._queryEngine = null;
  }
  load(e, r) {
    var _this = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const {
          getFeatureUrl: a,
          getFeatureOutputFormat: i,
          fields: o,
          geometryType: n,
          featureType: l,
          objectIdField: c,
          customParameters: m
        } = e,
        {
          spatialReference: y,
          getFeatureSpatialReference: g
        } = (0,_ogc_wfsUtils_js__WEBPACK_IMPORTED_MODULE_12__.getGetFeatureSpatialReference)(a, l, e.spatialReference);
      _this._featureType = l, _this._customParameters = m, _this._getFeatureUrl = a, _this._getFeatureOutputFormat = i, _this._getFeatureSpatialReference = g;
      try {
        yield (0,_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__.checkProjectionSupport)(g, y);
      } catch {
        throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("unsupported-projection", "Projection not supported", {
          inSpatialReference: g,
          outSpatialReference: y
        });
      }
      (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.throwIfAborted)(r);
      const F = _support_FieldsIndex_js__WEBPACK_IMPORTED_MODULE_13__["default"].fromLayerJSON({
          fields: o,
          dateFieldsTimeReference: o.some(e => "esriFieldTypeDate" === e.type) ? {
            timeZoneIANA: _time_timeZoneUtils_js__WEBPACK_IMPORTED_MODULE_14__.utc
          } : null
        }),
        w = yield _this._snapshotFeatures({
          fieldsIndex: F,
          geometryType: n,
          objectIdField: c,
          spatialReference: y
        }, r.signal);
      return _this._queryEngine = new _data_QueryEngine_js__WEBPACK_IMPORTED_MODULE_9__.QueryEngine({
        fieldsIndex: F,
        geometryType: n,
        hasM: !1,
        hasZ: !1,
        objectIdField: c,
        spatialReference: y,
        timeInfo: null,
        featureStore: new _data_FeatureStore_js__WEBPACK_IMPORTED_MODULE_7__["default"]({
          geometryType: n,
          hasM: !1,
          hasZ: !1
        })
      }), _this._queryEngine.featureStore.addMany(w), {
        extent: (yield _this._queryEngine.fetchRecomputedExtents()).fullExtent
      };
    })();
  }
  applyEdits() {
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("wfs-source:editing-not-supported", "applyEdits() is not supported on WFSLayer");
    })();
  }
  queryFeatures(e = {}, t = {}) {
    var _this2 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return yield _this2._waitSnapshotComplete(), _this2._queryEngine.executeQuery(e, t.signal);
    })();
  }
  queryFeatureCount(e = {}, t = {}) {
    var _this3 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return yield _this3._waitSnapshotComplete(), _this3._queryEngine.executeQueryForCount(e, t.signal);
    })();
  }
  queryObjectIds(e = {}, t = {}) {
    var _this4 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return yield _this4._waitSnapshotComplete(), _this4._queryEngine.executeQueryForIds(e, t.signal);
    })();
  }
  queryExtent(e = {}, t = {}) {
    var _this5 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return yield _this5._waitSnapshotComplete(), _this5._queryEngine.executeQueryForExtent(e, t.signal);
    })();
  }
  querySnapping(e, t = {}) {
    var _this6 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return yield _this6._waitSnapshotComplete(), _this6._queryEngine.executeQueryForSnapping(e, t.signal);
    })();
  }
  refresh(s) {
    var _this7 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return _this7._customParameters = s, _this7._snapshotTask?.abort(), _this7._snapshotTask = (0,_core_asyncUtils_js__WEBPACK_IMPORTED_MODULE_1__.createTask)(e => _this7._snapshotFeatures(_this7._queryEngine, e)), _this7._snapshotTask.promise.then(e => {
        _this7._queryEngine.featureStore.clear(), e && _this7._queryEngine.featureStore.addMany(e);
      }, e => {
        _this7._queryEngine.featureStore.clear(), (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.isAbortError)(e) || _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__["default"].getLogger("esri.layers.WFSLayer").error(new _core_Error_js__WEBPACK_IMPORTED_MODULE_2__["default"]("wfs-layer:getfeature-error", "An error occurred during the GetFeature request", {
          error: e
        }));
      }), yield _this7._waitSnapshotComplete(), {
        extent: (yield _this7._queryEngine.fetchRecomputedExtents()).fullExtent
      };
    })();
  }
  _waitSnapshotComplete() {
    var _this8 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      if (_this8._snapshotTask && !_this8._snapshotTask.finished) {
        try {
          yield _this8._snapshotTask.promise;
        } catch {}
        return _this8._waitSnapshotComplete();
      }
    })();
  }
  _snapshotFeatures({
    objectIdField: e,
    geometryType: t,
    spatialReference: r,
    fieldsIndex: a
  }, u) {
    var _this9 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const p = yield (0,_ogc_wfsUtils_js__WEBPACK_IMPORTED_MODULE_12__.getFeature)(_this9._getFeatureUrl ?? "", _this9._featureType.typeName, _this9._getFeatureSpatialReference, _this9._getFeatureOutputFormat, {
        customParameters: _this9._customParameters,
        signal: u
      });
      (0,_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_10__.validateGeoJSON)(p, _this9._getFeatureSpatialReference.wkid), (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_4__.throwIfAborted)(u);
      const h = (0,_geojson_geojson_js__WEBPACK_IMPORTED_MODULE_10__.createOptimizedFeatures)(p, {
        geometryType: t,
        hasZ: !1,
        objectIdField: e
      });
      if (!(0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_5__.equals)(r, _this9._getFeatureSpatialReference)) for (const s of h) null != s.geometry && (s.geometry = (0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.convertFromGeometry)((0,_data_projectionSupport_js__WEBPACK_IMPORTED_MODULE_8__.project)((0,_featureConversionUtils_js__WEBPACK_IMPORTED_MODULE_6__.convertToGeometry)(s.geometry, t, !1, !1), _this9._getFeatureSpatialReference, r)));
      let f = 1;
      for (const s of h) {
        const t = {};
        (0,_support_sourceUtils_js__WEBPACK_IMPORTED_MODULE_11__.mixAttributes)(a, t, s.attributes, !0), s.attributes = t, null == t[e] && (s.objectId = t[e] = f++);
      }
      return h;
    })();
  }
}


/***/ })

}]);
//# sourceMappingURL=node_modules_arcgis_core_layers_graphics_sources_WFSSourceWorker_js.js.map