{"version":3,"file":"node_modules_arcgis_core_widgets_Editor_Upload_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/widgets/Editor/Upload.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Accessor.js\";import{createTask as o}from\"../../core/asyncUtils.js\";import s from\"../../core/Error.js\";import{on as t}from\"../../core/events.js\";import{throwIfAborted as i,createResolver as l}from\"../../core/promiseUtils.js\";import{property as a}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as n}from\"../../core/accessorSupport/decorators/subclass.js\";import p from\"../../geometry/Point.js\";import{uploadProgressWeights as c}from\"../../layers/graphics/sources/support/uploadProgressWeights.js\";import{getSupportedExtensions as u}from\"../../layers/support/infoFor3D.js\";import{makeProgressManager as d,estimatedTransferTime as m}from\"../../support/progressUtils.js\";let f=class extends r{constructor(){super({}),this.files=[],this.progress=0,this._uploadTask=null,this._layer=null}destroy(){this.cancel(),this.files=[],this._layer=null,this._uploadTask=null}get state(){const e=this._uploadTask;return e&&0!==this.files.length?e.finished?e.error?\"error\":\"success\":\"pending\":\"default\"}get result(){return this._uploadTask?.value??null}get error(){return this._uploadTask?.error??null}uploadTo(e){this.cancel(),this.files=[],this._layer=e,this._uploadTask=o((async r=>{const o=await y(e);i(r),this.progress=0,this.files=o;const t=d(c.upload,(e=>{this.progress=e}),\"Upload.uploadTo\");if(0===o.length)return null;const{default:l}=await import(\"../../geometry/Mesh.js\");i(r);const a=await l.extractAndFilterFiles(o,e);i(r),a.length>0&&(this.files=a);const n=new p({x:0,y:0,z:0,spatialReference:e.spatialReference}),u=await l.createFromFiles(n,a,{layer:e,signal:r,onProgress:t.makeOnProgress(\"createFromFiles\")});if(i(r),!u)throw new s(\"editor:upload\",\"could not upload or convert model\");const f=a.reduce(((e,r)=>e+r.size),0),h=t.simulate(\"loadMesh\",m(f));try{await u.load()}finally{h.remove()}return u}))}retry(){this._layer&&this.uploadTo(this._layer)}cancel(){this._uploadTask?.abort()}};e([a()],f.prototype,\"files\",void 0),e([a()],f.prototype,\"progress\",void 0),e([a()],f.prototype,\"state\",null),e([a()],f.prototype,\"result\",null),e([a()],f.prototype,\"error\",null),e([a()],f.prototype,\"_uploadTask\",void 0),e([a()],f.prototype,\"_layer\",void 0),f=e([n(\"esri.widgets.Editor.Upload\")],f);let h=null;async function y(e){const{resolve:r,promise:o}=l(),s=document.createElement(\"input\");s.type=\"file\",s.multiple=!1,s.accept=[...u(e.infoFor3D),\".zip\"].join(\",\"),s.style.display=\"none\",document.body.appendChild(s);const i=t(s,\"change\",(()=>r(s.files?Array.from(s.files):[])));return h?h(s):s.click(),o.finally((()=>{i.remove(),s.remove()}))}function g(e){h=r=>{Promise.resolve().then((()=>e)).then((e=>{if(!h)return;const o=new DataTransfer;e.forEach((e=>o.items.add(e))),r.files=o.files,r.dispatchEvent(new Event(\"change\"))}))}}function j(){h=null}export{f as Upload,j as clearPromptForFilesStub,g as stubFilePickerToSelect};\n"],"names":["_","e","r","createTask","o","s","on","t","throwIfAborted","i","createResolver","l","property","a","subclass","n","p","uploadProgressWeights","c","getSupportedExtensions","u","makeProgressManager","d","estimatedTransferTime","m","f","constructor","files","progress","_uploadTask","_layer","destroy","cancel","state","length","finished","error","result","value","uploadTo","y","upload","default","extractAndFilterFiles","x","z","spatialReference","createFromFiles","layer","signal","onProgress","makeOnProgress","reduce","size","h","simulate","load","remove","retry","abort","prototype","resolve","promise","document","createElement","type","multiple","accept","infoFor3D","join","style","display","body","appendChild","Array","from","click","finally","g","Promise","then","DataTransfer","forEach","items","add","dispatchEvent","Event","j","Upload","clearPromptForFilesStub","stubFilePickerToSelect"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}