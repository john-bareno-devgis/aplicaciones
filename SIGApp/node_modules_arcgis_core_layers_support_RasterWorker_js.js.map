{"version":3,"file":"node_modules_arcgis_core_layers_support_RasterWorker_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/layers/support/RasterWorker.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport\"../../geometry.js\";import r from\"../../geometry/support/GeographicTransformation.js\";import e from\"./PixelBlock.js\";import{decode as t}from\"./rasterFormats/RasterCodec.js\";import{split as s,mosaic as o,approximateTransform as i,getLocalArithmeticNorthRotations as n}from\"./rasterFunctions/pixelUtils.js\";import{create as a}from\"./rasterFunctions/rasterFunctionHelper.js\";import{requirePE as l,load as m,getProjectionOffsetGrid as c}from\"./rasterFunctions/rasterProjectionHelper.js\";import{computeStatisticsHistograms as f,estimateStatisticsHistograms as p}from\"./rasterFunctions/stretchUtils.js\";import{convertVectorFieldData as u,convertToLocalDirections as S}from\"./rasterFunctions/vectorFieldUtils.js\";import{readTransform as d}from\"./rasterTransforms/utils.js\";import y from\"../../renderers/support/RasterSymbolizer.js\";import{createFlowMesh as x}from\"../../views/2d/engine/flow/dataUtils.js\";import h from\"../../geometry/Extent.js\";import O from\"../../geometry/Point.js\";class N{convertVectorFieldData(r){const t=e.fromJSON(r.pixelBlock),s=u(t,r.type);return Promise.resolve(null!=s?s.toJSON():null)}computeStatisticsHistograms(r){const t=e.fromJSON(r.pixelBlock),s=f(t);return Promise.resolve(s)}async decode(r){const e=await t(r.data,r.options);return e&&e.toJSON()}symbolize(r){r.pixelBlock=e.fromJSON(r.pixelBlock),r.extent=r.extent?h.fromJSON(r.extent):null;const t=this.symbolizer.symbolize(r);return Promise.resolve(null!=t?t.toJSON():null)}async updateSymbolizer(r){this.symbolizer=y.fromJSON(r.symbolizerJSON),r.histograms&&\"rasterStretch\"===this.symbolizer?.rendererJSON.type&&(this.symbolizer.rendererJSON.histograms=r.histograms)}async updateRasterFunction(r){this.rasterFunction=a(r.rasterFunctionJSON)}async process(r){const t=this.rasterFunction.process({extent:h.fromJSON(r.extent),primaryPixelBlocks:r.primaryPixelBlocks.map((r=>null!=r?e.fromJSON(r):null)),primaryPixelSizes:r.primaryPixelSizes?.map((r=>null!=r?O.fromJSON(r):null)),primaryRasterIds:r.primaryRasterIds});return null!=t?t.toJSON():null}stretch(r){const t=this.symbolizer.simpleStretch(e.fromJSON(r.srcPixelBlock),r.stretchParams);return Promise.resolve(t?.toJSON())}estimateStatisticsHistograms(r){const t=p(e.fromJSON(r.srcPixelBlock));return Promise.resolve(t)}split(r){const t=s(e.fromJSON(r.srcPixelBlock),r.tileSize,r.maximumPyramidLevel);return t&&t.forEach(((r,e)=>{t.set(e,r?.toJSON())})),Promise.resolve(t)}async mosaicAndTransform(r){const t=r.srcPixelBlocks.map((r=>r?new e(r):null)),s=o(t,r.srcMosaicSize,{blockWidths:r.blockWidths,alignmentInfo:r.alignmentInfo,clipOffset:r.clipOffset,clipSize:r.clipSize});let a,l=s;return r.coefs&&(l=i(s,r.destDimension,r.coefs,r.sampleSpacing,r.interpolation)),r.projectDirections&&r.gcsGrid&&(a=n(r.destDimension,r.gcsGrid),l=S(l,r.isUV?\"vector-uv\":\"vector-magdir\",a)),{pixelBlock:l?.toJSON(),localNorthDirections:a}}async createFlowMesh(r,e){const t={data:new Float32Array(r.flowData.buffer),mask:new Uint8Array(r.flowData.maskBuffer),width:r.flowData.width,height:r.flowData.height},{vertexData:s,indexData:o}=await x(r.meshType,r.simulationSettings,t,e.signal);return{result:{vertexBuffer:s.buffer,indexBuffer:o.buffer},transferList:[s.buffer,o.buffer]}}async getProjectionOffsetGrid(e){const t=h.fromJSON(e.projectedExtent),s=h.fromJSON(e.srcBufferExtent);let o=null;e.datumTransformationSteps&&(o=new r({steps:e.datumTransformationSteps})),(e.includeGCSGrid||l(t.spatialReference,s.spatialReference,o))&&await m();const i=e.rasterTransform?d(e.rasterTransform):null;return c({...e,projectedExtent:t,srcBufferExtent:s,datumTransformation:o,rasterTransform:i})}}export{N as default};\n"],"names":["r","e","decode","t","split","s","mosaic","o","approximateTransform","i","getLocalArithmeticNorthRotations","n","create","a","requirePE","l","load","m","getProjectionOffsetGrid","c","computeStatisticsHistograms","f","estimateStatisticsHistograms","p","convertVectorFieldData","u","convertToLocalDirections","S","readTransform","d","y","createFlowMesh","x","h","O","N","fromJSON","pixelBlock","type","Promise","resolve","toJSON","data","options","symbolize","extent","symbolizer","updateSymbolizer","symbolizerJSON","histograms","rendererJSON","updateRasterFunction","rasterFunction","rasterFunctionJSON","process","primaryPixelBlocks","map","primaryPixelSizes","primaryRasterIds","stretch","simpleStretch","srcPixelBlock","stretchParams","tileSize","maximumPyramidLevel","forEach","set","mosaicAndTransform","srcPixelBlocks","srcMosaicSize","blockWidths","alignmentInfo","clipOffset","clipSize","coefs","destDimension","sampleSpacing","interpolation","projectDirections","gcsGrid","isUV","localNorthDirections","Float32Array","flowData","buffer","mask","Uint8Array","maskBuffer","width","height","vertexData","indexData","meshType","simulationSettings","signal","result","vertexBuffer","indexBuffer","transferList","projectedExtent","srcBufferExtent","datumTransformationSteps","steps","includeGCSGrid","spatialReference","rasterTransform","datumTransformation","default"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}