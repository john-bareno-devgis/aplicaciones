"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["default-node_modules_arcgis_core_layers_graphics_editingSupport_js"],{

/***/ 56026:
/*!*********************************************************************!*\
  !*** ./node_modules/@arcgis/core/layers/graphics/editingSupport.js ***!
  \*********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "applyEdits": () => (/* binding */ A),
/* harmony export */   "checkEditingCapabilities": () => (/* binding */ T),
/* harmony export */   "isFeatureIdentifierArrayWithGlobalId": () => (/* binding */ F),
/* harmony export */   "isFeatureIdentifierArrayWithObjectId": () => (/* binding */ b),
/* harmony export */   "isFeatureIdentifierWithGlobalId": () => (/* binding */ w),
/* harmony export */   "isFeatureIdentifierWithObjectId": () => (/* binding */ g),
/* harmony export */   "normalizeCollections": () => (/* binding */ k),
/* harmony export */   "normalizeEdits": () => (/* binding */ B),
/* harmony export */   "normalizeGeometries": () => (/* binding */ L),
/* harmony export */   "shallowCloneFeature": () => (/* binding */ D),
/* harmony export */   "uploadAssets": () => (/* binding */ M)
/* harmony export */ });
/* harmony import */ var _home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../Graphic.js */ 26763);
/* harmony import */ var _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/Collection.js */ 28586);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../core/Error.js */ 32995);
/* harmony import */ var _core_lang_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../core/lang.js */ 88684);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../core/Logger.js */ 28191);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../core/promiseUtils.js */ 30801);
/* harmony import */ var _core_urlUtils_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../core/urlUtils.js */ 55050);
/* harmony import */ var _core_uuid_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../core/uuid.js */ 28772);
/* harmony import */ var _geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../geometry/support/normalizeUtils.js */ 93136);
/* harmony import */ var _mixins_EditBusLayer_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../mixins/EditBusLayer.js */ 79465);
/* harmony import */ var _support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../support/fieldUtils.js */ 32746);
/* harmony import */ var _support_infoFor3D_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../support/infoFor3D.js */ 11895);
/* harmony import */ var _support_layerUtils_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../support/layerUtils.js */ 63719);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/













function y(e) {
  return null != e?.applyEdits;
}
function g(e) {
  return "object" == typeof e && null != e && "objectId" in e && !!e.objectId;
}
function b(e) {
  return e.every(g);
}
function w(e) {
  return "object" == typeof e && null != e && "globalId" in e && !!e.globalId;
}
function F(e) {
  return e.every(w);
}
function A(_x, _x2, _x3) {
  return _A.apply(this, arguments);
}
function _A() {
  _A = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t, a, s = {}) {
    let i;
    const n = "gdbVersion" in e ? e.gdbVersion : null,
      d = s.gdbVersion ?? n;
    if ((0,_mixins_EditBusLayer_js__WEBPACK_IMPORTED_MODULE_10__.isEditBusLayer)(e) && e.url) i = (0,_mixins_EditBusLayer_js__WEBPACK_IMPORTED_MODULE_10__.emitApplyEditsEvent)(e.url, e.layerId, d, "original-and-current-features" === s.returnServiceEditsOption);else {
      i = (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_6__.createResolver)(), i.promise.then(t => {
        (t.addedFeatures.length || t.updatedFeatures.length || t.deletedFeatures.length || t.addedAttachments.length || t.updatedAttachments.length || t.deletedAttachments.length) && e.emit("edits", t);
      });
      const t = {
        result: i.promise
      };
      e.emit("apply-edits", t);
    }
    try {
      const {
          results: o,
          edits: n
        } = yield v(e, t, a, s),
        d = e => e.filter(e => !e.error).map(_core_lang_js__WEBPACK_IMPORTED_MODULE_4__.clone),
        l = {
          edits: n,
          addedFeatures: d(o.addFeatureResults),
          updatedFeatures: d(o.updateFeatureResults),
          deletedFeatures: d(o.deleteFeatureResults),
          addedAttachments: d(o.addAttachmentResults),
          updatedAttachments: d(o.updateAttachmentResults),
          deletedAttachments: d(o.deleteAttachmentResults),
          exceededTransferLimit: !1,
          historicMoment: o.editMoment ? new Date(o.editMoment) : null,
          globalIdToObjectId: s.globalIdToObjectId
        };
      return o.editedFeatureResults?.length && (l.editedFeatures = o.editedFeatureResults), i.resolve(l), o;
    } catch (p) {
      throw i.reject(p), p;
    }
  });
  return _A.apply(this, arguments);
}
function v(_x4, _x5, _x6, _x7) {
  return _v.apply(this, arguments);
}
function _v() {
  _v = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t, r, s) {
    if (yield e.load(), !y(t)) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:no-editing-support`, "Layer source does not support applyEdits capability", {
      layer: e
    });
    if (!(0,_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_13__.getEffectiveEditingEnabled)(e)) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:editing-disabled`, "Editing is disabled for layer", {
      layer: e
    });
    const {
      edits: o,
      options: i
    } = yield I(e, r, s);
    return o.addFeatures?.length || o.updateFeatures?.length || o.deleteFeatures?.length || o.addAttachments?.length || o.updateAttachments?.length || o.deleteAttachments?.length ? {
      edits: o,
      results: yield t.applyEdits(o, i)
    } : {
      edits: o,
      results: {
        addFeatureResults: [],
        updateFeatureResults: [],
        deleteFeatureResults: [],
        addAttachmentResults: [],
        updateAttachmentResults: [],
        deleteAttachmentResults: []
      }
    };
  });
  return _v.apply(this, arguments);
}
function I(_x8, _x9, _x10) {
  return _I.apply(this, arguments);
}
function _I() {
  _I = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t, r) {
    const o = (0,_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_13__.getEffectiveLayerCapabilities)(e),
      i = t && (t.addFeatures || t.updateFeatures || t.deleteFeatures),
      n = t && (t.addAttachments || t.updateAttachments || t.deleteAttachments),
      d = null != e.infoFor3D;
    if (T(t, o, r, !!i, !!n, `${e.type}-layer`), !o.data.isVersioned && r?.gdbVersion) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:invalid-parameter`, "'gdbVersion' is applicable only if the layer supports versioned data. See: 'capabilities.data.isVersioned'");
    if (!o.editing.supportsRollbackOnFailure && r?.rollbackOnFailureEnabled) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:invalid-parameter`, "This layer does not support 'rollbackOnFailureEnabled' parameter. See: 'capabilities.editing.supportsRollbackOnFailure'");
    const l = {
      ...r
    };
    if (null != l.rollbackOnFailureEnabled || o.editing.supportsRollbackOnFailure || (l.rollbackOnFailureEnabled = !0), l.rollbackOnFailureEnabled || "original-and-current-features" !== l.returnServiceEditsOption || (!1 === l.rollbackOnFailureEnabled && _core_Logger_js__WEBPACK_IMPORTED_MODULE_5__["default"].getLogger("esri.layers.graphics.editingSupport").warn(`${e.type}-layer:invalid-parameter`, "'original-and-current-features' is valid for 'returnServiceEditsOption' only when 'rollBackOnFailure' is true, but 'rollBackOnFailure' was set to false. 'rollBackOnFailure' has been overwrritten and set to true."), l.rollbackOnFailureEnabled = !0), !o.editing.supportsReturnServiceEditsInSourceSpatialReference && l.returnServiceEditsInSourceSR) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:invalid-parameter`, "This layer does not support 'returnServiceEditsInSourceSR' parameter. See: 'capabilities.editing.supportsReturnServiceEditsInSourceSpatialReference'");
    if (l.returnServiceEditsInSourceSR && "original-and-current-features" !== l.returnServiceEditsOption) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:invalid-parameter`, "'returnServiceEditsInSourceSR' is valid only when 'returnServiceEditsOption' is set to 'original-and-current-features'");
    const u = B(t, o, `${e.type}-layer`),
      p = r?.globalIdUsed || d,
      c = e.fields.filter(e => "big-integer" === e.type || "oid" === e.type && (e.length || 0) >= 8);
    if (p) {
      const {
        globalIdField: t
      } = e;
      if (null == t) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:invalid-parameter`, "Layer does not specify a global id field.");
      u.addFeatures.forEach(e => U(e, t));
    }
    u.addFeatures.forEach(t => S(t, e, p, c)), u.updateFeatures.forEach(t => j(t, e, p, c)), u.deleteFeatures.forEach(t => R(t, e, p, c)), u.addAttachments.forEach(t => O(t, e)), u.updateAttachments.forEach(t => O(t, e)), d && (yield G(u, e));
    return {
      edits: yield L(u),
      options: l
    };
  });
  return _I.apply(this, arguments);
}
function $(e, t, r, s) {
  if (r) {
    if ("attributes" in e && !e.attributes[t.globalIdField]) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, `Feature should have '${t.globalIdField}' when 'globalIdUsed' is true`);
    if (!("attributes" in e) && !e.globalId) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "`'globalId' of the feature should be passed when 'globalIdUsed' is true");
  }
  if (s.length && "attributes" in e) for (const o of s) {
    const r = e.attributes[o.name];
    if (void 0 !== r && !(0,_support_fieldUtils_js__WEBPACK_IMPORTED_MODULE_11__.isValidFieldValue)(o, r)) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, `Big-integer field '${o.name}' of the feature must be less than ${Number.MAX_SAFE_INTEGER}`, {
      feature: e
    });
  }
  if ("geometry" in e && null != e.geometry) {
    if (e.geometry.hasZ && !1 === t.capabilities?.data.supportsZ) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:z-unsupported`, "Layer does not support z values while feature has z values.");
    if (e.geometry.hasM && !1 === t.capabilities?.data.supportsM) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:m-unsupported`, "Layer does not support m values while feature has m values.");
  }
}
function E(e, t) {
  if ("geometry" in e && "mesh" === e.geometry?.type && null != t.infoFor3D) {
    const {
      geometry: r
    } = e;
    if (r.vertexSpace.isGeoreferenced) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:georeferenced-mesh-unsupported`, "Uploading georeferenced meshes to a layer is not supported.");
  }
}
function S(e, t, a, r) {
  $(e, t, a, r), E(e, t);
}
function R(e, t, a, r) {
  $(e, t, a, r);
}
function j(e, t, r, s) {
  $(e, t, r, s), E(e, t);
  const o = (0,_support_layerUtils_js__WEBPACK_IMPORTED_MODULE_13__.getEffectiveLayerCapabilities)(t);
  if ("geometry" in e && null != e.geometry && !o?.editing.supportsGeometryUpdate) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:unsupported-operation`, "Layer does not support geometry updates.");
}
function O(e, t) {
  const {
    feature: r,
    attachment: s
  } = e;
  if (!r || "attributes" in r && !r.attributes[t.globalIdField]) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "Attachment should have reference to a feature with 'globalId'");
  if (!("attributes" in r) && !r.globalId) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "Attachment should have reference to 'globalId' of the parent feature");
  if (!s.globalId) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "Attachment should have 'globalId'");
  if (!s.data && !s.uploadId) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "Attachment should have 'data' or 'uploadId'");
  if (!(s.data instanceof File && !!s.data.name) && !s.name) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "'name' is required when attachment is specified as Base64 encoded string using 'data'");
  if (!t.capabilities?.editing.supportsUploadWithItemId && s.uploadId) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "This layer does not support 'uploadId' parameter. See: 'capabilities.editing.supportsUploadWithItemId'");
  if ("string" == typeof s.data) {
    const e = (0,_core_urlUtils_js__WEBPACK_IMPORTED_MODULE_7__.dataComponents)(s.data);
    if (e && !e.isBase64) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:invalid-parameter`, "Attachment 'data' should be a Blob, File or Base64 encoded string");
  }
}
function U(e, t) {
  const {
    attributes: a
  } = e;
  null == a[t] && (a[t] = (0,_core_uuid_js__WEBPACK_IMPORTED_MODULE_8__.generateBracedUUID)());
}
function L(_x11) {
  return _L.apply(this, arguments);
}
function _L() {
  _L = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e) {
    const t = e.addFeatures ?? [],
      a = e.updateFeatures ?? [],
      r = t.concat(a).map(e => e.geometry),
      s = yield (0,_geometry_support_normalizeUtils_js__WEBPACK_IMPORTED_MODULE_9__.normalizeCentralMeridian)(r),
      o = t.length,
      i = a.length;
    return s.slice(0, o).forEach((e, a) => t[a].geometry = e), s.slice(o, o + i).forEach((e, t) => a[t].geometry = e), e;
  });
  return _L.apply(this, arguments);
}
function k(e) {
  return {
    addFeatures: Array.from(e?.addFeatures ?? []),
    updateFeatures: Array.from(e?.updateFeatures ?? []),
    deleteFeatures: e && _core_Collection_js__WEBPACK_IMPORTED_MODULE_2__["default"].isCollection(e.deleteFeatures) ? e.deleteFeatures.toArray() : e.deleteFeatures || [],
    addAttachments: e.addAttachments || [],
    updateAttachments: e.updateAttachments || [],
    deleteAttachments: e.deleteAttachments || []
  };
}
function B(e, t, r) {
  const s = k(e);
  if (s.addFeatures?.length && !t.operations.supportsAdd) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${r}:unsupported-operation`, "Layer does not support adding features.");
  if (s.updateFeatures?.length && !t.operations.supportsUpdate) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${r}:unsupported-operation`, "Layer does not support updating features.");
  if (s.deleteFeatures?.length && !t.operations.supportsDelete) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${r}:unsupported-operation`, "Layer does not support deleting features.");
  return s.addFeatures = s.addFeatures.map(D), s.updateFeatures = s.updateFeatures.map(D), s.addAssetFeatures = [], s;
}
function T(e, t, r, s, o, i) {
  if (!e || !s && !o) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${i}:missing-parameters`, "'addFeatures', 'updateFeatures', 'deleteFeatures', 'addAttachments', 'updateAttachments' or 'deleteAttachments' parameter is required");
  if (!t.editing.supportsGlobalId && r?.globalIdUsed) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${i}:invalid-parameter`, "This layer does not support 'globalIdUsed' parameter. See: 'capabilities.editing.supportsGlobalId'");
  if (!t.editing.supportsGlobalId && o) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${i}:invalid-parameter`, "'addAttachments', 'updateAttachments' and 'deleteAttachments' are applicable only if the layer supports global ids. See: 'capabilities.editing.supportsGlobalId'");
  if (!r?.globalIdUsed && o) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${i}:invalid-parameter`, "When 'addAttachments', 'updateAttachments' or 'deleteAttachments' is specified, globalIdUsed should be set to true");
}
function D(t) {
  const a = new _Graphic_js__WEBPACK_IMPORTED_MODULE_1__["default"]();
  return t.attributes || (t.attributes = {}), a.geometry = t.geometry, a.attributes = t.attributes, a;
}
function G(_x12, _x13) {
  return _G.apply(this, arguments);
}
function _G() {
  _G = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t) {
    if (null == t.infoFor3D) return;
    const {
        infoFor3D: r
      } = t,
      s = (0,_support_infoFor3D_js__WEBPACK_IMPORTED_MODULE_12__.getMimeTypeFormatId)("model/gltf-binary", r.supportedFormats) ?? (0,_support_infoFor3D_js__WEBPACK_IMPORTED_MODULE_12__.getFilenameFormatId)("glb", r.supportedFormats);
    if (!(!!s && r.editFormats.includes(s))) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${t.type}-layer:binary-gltf-asset-not-supported`, "3DObjectFeatureLayer requires binary glTF (.glb) support for updating mesh geometry.");
    e.addAssetFeatures ??= [];
    const {
      addAssetFeatures: o
    } = e;
    for (const a of e.addFeatures ?? []) V(a) && o.push(a);
    for (const a of e.updateFeatures ?? []) V(a) && o.push(a);
  });
  return _G.apply(this, arguments);
}
function V(e) {
  return "mesh" === e?.geometry?.type;
}
function M(e, t, r, s) {
  if (!y(t)) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:no-editing-support`, "Layer source does not support applyEdits capability", {
    layer: e
  });
  if (!t.uploadAssets) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_3__["default"](`${e.type}-layer:no-asset-upload-support`, "Layer source does not support uploadAssets capability", {
    layer: e
  });
  return t.uploadAssets(r, s);
}


/***/ })

}]);
//# sourceMappingURL=default-node_modules_arcgis_core_layers_graphics_editingSupport_js.js.map