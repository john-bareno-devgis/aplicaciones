{"version":3,"file":"node_modules_arcgis_core_views_2d_layers_WMSLayerView2D_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/views/2d/layers/WMSLayerView2D.js","./node_modules/@arcgis/core/views/layers/WMSLayerView.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import t from\"../../../core/Logger.js\";import{destroyMaybe as r}from\"../../../core/maybe.js\";import{isAbortError as i}from\"../../../core/promiseUtils.js\";import{watch as s}from\"../../../core/reactiveUtils.js\";import{property as a}from\"../../../core/accessorSupport/decorators/property.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/arrayUtils.js\";import\"../../../core/has.js\";import{subclass as o}from\"../../../core/accessorSupport/decorators/subclass.js\";import p from\"../../../geometry/Extent.js\";import{BitmapContainer as n}from\"../engine/BitmapContainer.js\";import{LayerView2DMixin as m}from\"./LayerView2D.js\";import h from\"./support/ExportStrategy.js\";import c from\"../../layers/LayerView.js\";import d from\"../../layers/RefreshableLayerView.js\";import u from\"../../layers/WMSLayerView.js\";let y=class extends(u(d(m(c)))){constructor(){super(...arguments),this.bitmapContainer=new n}supportsSpatialReference(e){return this.layer.serviceSupportsSpatialReference(e)}update(e){this.strategy.update(e).catch((e=>{i(e)||t.getLogger(this).error(e)}))}attach(){const{layer:e}=this,{imageMaxHeight:t,imageMaxWidth:r}=e;this.bitmapContainer=new n,this.container.addChild(this.bitmapContainer),this.strategy=new h({container:this.bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:t,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this.addAttachHandles(s((()=>this.exportImageVersion),(()=>this.requestUpdate())))}detach(){this.strategy=r(this.strategy),this.container.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t,bitmapContainer:r}=this,{x:i,y:s}=e,{spatialReference:a}=t;let o,n=0,m=0;if(r.children.some((e=>{const{width:t,height:r,resolution:h,x:c,y:d}=e,u=c+h*t,y=d-h*r;return i>=c&&i<=u&&s<=d&&s>=y&&(o=new p({xmin:c,ymin:y,xmax:u,ymax:d,spatialReference:a}),n=t,m=r,!0)})),!o)return null;const h=o.width/n,c=Math.round((i-o.xmin)/h),d=Math.round((o.ymax-s)/h);return{extent:o,width:n,height:m,x:c,y:d}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,r,i){return this.layer.fetchImageBitmap(e,t,r,{timeExtent:this.timeExtent,...i})}};e([a()],y.prototype,\"strategy\",void 0),e([a()],y.prototype,\"updating\",void 0),y=e([o(\"esri.views.2d.layers.WMSLayerView2D\")],y);const g=y;export{g as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../chunks/tslib.es6.js\";import r from\"../../core/Error.js\";import{destroyMaybe as t}from\"../../core/maybe.js\";import{property as o}from\"../../core/accessorSupport/decorators/property.js\";import\"../../core/accessorSupport/ensureType.js\";import\"../../core/arrayUtils.js\";import\"../../core/has.js\";import{subclass as s}from\"../../core/accessorSupport/decorators/subclass.js\";import{combinedViewLayerTimeExtentProperty as p}from\"../../layers/support/commonProperties.js\";import{ExportWMSImageParameters as a}from\"../../layers/support/ExportWMSImageParameters.js\";const i=i=>{let m=class extends i{initialize(){this.exportImageParameters=new a({layer:this.layer})}destroy(){this.exportImageParameters=t(this.exportImageParameters)}get exportImageVersion(){return this.exportImageParameters?.commitProperty(\"version\"),this.commitProperty(\"timeExtent\"),(this._get(\"exportImageVersion\")||0)+1}fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"Nothing to fetch without area\",{layer:t}));const{popupEnabled:o}=t;if(!o)return Promise.reject(new r(\"wmslayerview:fetchPopupFeatures\",\"popupEnabled should be true\",{popupEnabled:o}));const s=this.createFetchPopupFeaturesQuery(e);if(!s)return Promise.resolve([]);const{extent:p,width:a,height:i,x:m,y:n}=s;if(!(p&&a&&i))throw new r(\"wmslayerview:fetchPopupFeatures\",\"WMSLayer does not support fetching features.\",{extent:p,width:a,height:i});return t.fetchFeatureInfo(p,a,i,m,n)}};return e([o()],m.prototype,\"exportImageParameters\",void 0),e([o({readOnly:!0})],m.prototype,\"exportImageVersion\",null),e([o()],m.prototype,\"layer\",void 0),e([o(p)],m.prototype,\"timeExtent\",void 0),m=e([s(\"esri.layers.mixins.WMSLayerView\")],m),m};export{i as default};\n"],"names":["_","e","t","destroyMaybe","r","isAbortError","i","watch","s","property","a","subclass","o","p","BitmapContainer","n","LayerView2DMixin","m","h","c","d","u","y","constructor","arguments","bitmapContainer","supportsSpatialReference","layer","serviceSupportsSpatialReference","update","strategy","catch","getLogger","error","attach","imageMaxHeight","imageMaxWidth","container","addChild","fetchSource","fetchImage","bind","requestUpdate","imageRotationSupported","imageNormalizationSupported","hidpi","addAttachHandles","exportImageVersion","detach","removeAllChildren","moveStart","viewChange","moveEnd","createFetchPopupFeaturesQuery","view","x","spatialReference","children","some","width","height","resolution","xmin","ymin","xmax","ymax","Math","round","extent","doRefresh","isUpdating","updating","updateRequested","fetchImageBitmap","timeExtent","prototype","g","default","combinedViewLayerTimeExtentProperty","ExportWMSImageParameters","initialize","exportImageParameters","destroy","commitProperty","_get","fetchPopupFeatures","Promise","reject","popupEnabled","resolve","fetchFeatureInfo","readOnly"],"sourceRoot":"webpack:///","x_google_ignoreList":[0,1]}