"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["node_modules_arcgis_core_rest_support_meshFeatureSet_js"],{

/***/ 21831:
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/rest/support/meshFeatureSet.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "assetMapFromAssetMapsJSON": () => (/* binding */ M),
/* harmony export */   "extractMesh": () => (/* binding */ S),
/* harmony export */   "meshFeatureSetFromJSON": () => (/* binding */ y)
/* harmony export */ });
/* harmony import */ var _Graphic_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../Graphic.js */ 26763);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Logger.js */ 28191);
/* harmony import */ var _core_MapUtils_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../core/MapUtils.js */ 20359);
/* harmony import */ var _chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../chunks/vec3f64.js */ 77765);
/* harmony import */ var _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../geometry/Extent.js */ 10465);
/* harmony import */ var _geometry_Mesh_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../geometry/Mesh.js */ 9970);
/* harmony import */ var _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../geometry/Point.js */ 72062);
/* harmony import */ var _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../geometry/SpatialReference.js */ 68230);
/* harmony import */ var _geometry_support_MeshGeoreferencedRelativeVertexSpace_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../geometry/support/MeshGeoreferencedRelativeVertexSpace.js */ 80167);
/* harmony import */ var _geometry_support_MeshLocalVertexSpace_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../geometry/support/MeshLocalVertexSpace.js */ 72416);
/* harmony import */ var _geometry_support_MeshTransform_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../geometry/support/MeshTransform.js */ 84374);
/* harmony import */ var _geometry_support_meshUtils_External_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../geometry/support/meshUtils/External.js */ 92427);
/* harmony import */ var _layers_support_infoFor3D_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../layers/support/infoFor3D.js */ 11895);
/* harmony import */ var _FeatureSet_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ./FeatureSet.js */ 87096);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/














const h = () => _core_Logger_js__WEBPACK_IMPORTED_MODULE_1__["default"].getLogger("esri.rest.support.meshFeatureSet");
function y(t, r, o) {
  const n = o.features;
  o.features = [], delete o.geometryType;
  const s = _FeatureSet_js__WEBPACK_IMPORTED_MODULE_13__["default"].fromJSON(o);
  if (s.geometryType = "mesh", !o.assetMaps) return s;
  const i = M(r, o.assetMaps),
    u = t.sourceSpatialReference ?? _geometry_SpatialReference_js__WEBPACK_IMPORTED_MODULE_7__["default"].WGS84,
    c = o.globalIdFieldName,
    {
      outFields: f
    } = t,
    m = null != f && f.length > 0 ? E(f.includes("*") ? null : new Set(f)) : () => ({});
  for (const a of n) {
    const t = S(a, c, u, r, i);
    null != t && s.features.push(new _Graphic_js__WEBPACK_IMPORTED_MODULE_0__["default"]({
      geometry: t,
      attributes: m(a)
    }));
  }
  return s;
}
function E(e) {
  return ({
    attributes: t
  }) => {
    if (!t) return {};
    if (!e) return t;
    for (const r in t) e.has(r) || delete t[r];
    return t;
  };
}
function S(e, t, r, o, i) {
  const a = e.attributes[t],
    f = i.get(a);
  if (null == f) return h().error("mesh-feature-set:asset-not-found", "Service returned a feature which was not found in the asset map", e), null;
  if (!e.geometry) return h().error("mesh-feature-set:no-geometry", "Service returned a feature without geometry", e), null;
  const {
      originPoint: m,
      originVector: p
    } = d(e, r, o),
    l = _geometry_Extent_js__WEBPACK_IMPORTED_MODULE_4__["default"].fromJSON(e.geometry);
  l.spatialReference = r;
  const g = j(e.attributes, o),
    y = f.projectVertices ? new _geometry_support_MeshGeoreferencedRelativeVertexSpace_js__WEBPACK_IMPORTED_MODULE_8__["default"]({
      origin: p
    }) : new _geometry_support_MeshLocalVertexSpace_js__WEBPACK_IMPORTED_MODULE_9__["default"]({
      origin: p
    }),
    E = T(f);
  return E ? _geometry_Mesh_js__WEBPACK_IMPORTED_MODULE_5__["default"].createWithExternalSource(m, E, {
    extent: l,
    transform: g,
    vertexSpace: y
  }) : _geometry_Mesh_js__WEBPACK_IMPORTED_MODULE_5__["default"].createIncomplete(m, {
    extent: l,
    transform: g,
    vertexSpace: y
  });
}
function d({
  attributes: e
}, t, {
  transformFieldRoles: r
}) {
  const n = e[r.originX],
    s = e[r.originY],
    a = e[r.originZ];
  return {
    originPoint: new _geometry_Point_js__WEBPACK_IMPORTED_MODULE_6__["default"]({
      x: n,
      y: s,
      z: a,
      spatialReference: t
    }),
    originVector: (0,_chunks_vec3f64_js__WEBPACK_IMPORTED_MODULE_3__.f)(n, s, a)
  };
}
function j(e, {
  transformFieldRoles: t
}) {
  return new _geometry_support_MeshTransform_js__WEBPACK_IMPORTED_MODULE_10__["default"]({
    translation: [e[t.translationX], -e[t.translationZ], e[t.translationY]],
    rotationAxis: [e[t.rotationX], -e[t.rotationZ], e[t.rotationY]],
    rotationAngle: e[t.rotationDeg],
    scale: [e[t.scaleX], e[t.scaleZ], e[t.scaleY]]
  });
}
var w;
function M(e, t) {
  const o = new Map();
  for (const n of t) {
    const t = n.parentGlobalId;
    if (null == t) continue;
    const s = n.assetName,
      i = n.assetType,
      a = n.assetHash,
      u = n.assetURL,
      c = n.conversionStatus,
      f = n.seqNo,
      m = (0,_layers_support_infoFor3D_js__WEBPACK_IMPORTED_MODULE_12__.getFormatIdMimeType)(i, e.supportedFormats);
    if (!m) {
      h().error("mesh-feature-set:unknown-format", `Service returned an asset of type ${i}, but it does not list it as a supported type`);
      continue;
    }
    const p = (0,_core_MapUtils_js__WEBPACK_IMPORTED_MODULE_2__.getOrCreateMapValue)(o, t, () => ({
      projectVertices: P(n.flags).projectVertices,
      files: new Map()
    }));
    (0,_core_MapUtils_js__WEBPACK_IMPORTED_MODULE_2__.getOrCreateMapValue)(p.files, s, () => ({
      name: s,
      type: i,
      mimeType: m,
      status: D(c),
      parts: []
    })).parts[f] = {
      hash: a,
      url: u
    };
  }
  return o;
}
function T(e) {
  const t = Array.from(e.files.values()),
    r = new Array();
  for (const o of t) {
    if (o.status !== w.COMPLETED) return null;
    const e = new Array();
    for (const t of o.parts) {
      if (!t) return null;
      e.push(new _geometry_support_meshUtils_External_js__WEBPACK_IMPORTED_MODULE_11__.ServiceAssetPart(t.url, t.hash));
    }
    r.push(new _geometry_support_meshUtils_External_js__WEBPACK_IMPORTED_MODULE_11__.ServiceAsset(o.name, o.mimeType, e));
  }
  return r;
}
function D(e) {
  switch (e) {
    case "COMPLETED":
    case "SUBMITTED":
      return w.COMPLETED;
    case "INPROGRESS":
      return w.PENDING;
    default:
      return w.FAILED;
  }
}
function P(e) {
  return {
    projectVertices: e.includes("PROJECT_VERTICES")
  };
}
!function (e) {
  e[e.FAILED = 0] = "FAILED", e[e.PENDING = 1] = "PENDING", e[e.COMPLETED = 2] = "COMPLETED";
}(w || (w = {}));


/***/ })

}]);
//# sourceMappingURL=node_modules_arcgis_core_rest_support_meshFeatureSet_js.js.map