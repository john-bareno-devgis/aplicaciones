{"version":3,"file":"node_modules_arcgis_core_views_2d_layers_MapNotesLayerView2D_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/views/2d/layers/MapNotesLayerView2D.js","./node_modules/@arcgis/core/views/2d/layers/graphics/GraphicContainer.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../chunks/tslib.es6.js\";import i from\"../../../Graphic.js\";import{isSome as s}from\"../../../core/arrayUtils.js\";import t from\"../../../core/Collection.js\";import{makeHandle as r}from\"../../../core/handleUtils.js\";import{watch as h,on as a,initial as o}from\"../../../core/reactiveUtils.js\";import\"../../../core/Logger.js\";import\"../../../core/accessorSupport/ensureType.js\";import\"../../../core/has.js\";import\"../../../core/Error.js\";import{subclass as l}from\"../../../core/accessorSupport/decorators/subclass.js\";import{LayerView2DMixin as n}from\"./LayerView2D.js\";import p from\"./graphics/GraphicContainer.js\";import c from\"./graphics/GraphicsView2D.js\";import g from\"../../layers/LayerView.js\";const d=\"sublayers\",u=\"layerView\";let f=class extends(n(g)){constructor(){super(...arguments),this._highlightIds=new Map}async fetchPopupFeatures(e){return Array.from(this.graphicsViews(),(i=>i.hitTest(e).filter((e=>!!e.popupTemplate)))).flat()}*graphicsViews(){null==this._graphicsViewsFeatureCollectionMap?null==this._graphicsViews?yield*[]:yield*this._graphicsViews:yield*this._graphicsViewsFeatureCollectionMap.keys()}async hitTest(e,i){return Array.from(this.graphicsViews(),(i=>{const s=i.hitTest(e);if(null!=this._graphicsViewsFeatureCollectionMap){const e=this._graphicsViewsFeatureCollectionMap.get(i);for(const i of s)!i.popupTemplate&&e.popupTemplate&&(i.popupTemplate=e.popupTemplate),i.sourceLayer=i.layer=this.layer}return s})).flat().map((i=>({type:\"graphic\",graphic:i,layer:this.layer,mapPoint:e})))}highlight(e){let h;\"number\"==typeof e?h=[e]:e instanceof i?h=[e.uid]:Array.isArray(e)&&e.length>0?h=\"number\"==typeof e[0]?e:e.map((e=>e&&e.uid)):t.isCollection(e)&&(h=e.map((e=>e&&e.uid)).toArray());const a=h?.filter(s);return a?.length?(this._addHighlight(a),r((()=>this._removeHighlight(a)))):r()}update(e){for(const i of this.graphicsViews())i.processUpdate(e)}attach(){const e=this.view,i=()=>this.requestUpdate(),s=this.layer.featureCollections;if(null!=s&&s.length){this._graphicsViewsFeatureCollectionMap=new Map;for(const t of s){const s=new p(this.view.featuresTilingScheme),r=new c({view:e,graphics:t.source,renderer:t.renderer,requestUpdateCallback:i,container:s});this._graphicsViewsFeatureCollectionMap.set(r,t),this.container.addChild(r.container),this.addHandles([h((()=>t.visible),(e=>r.container.visible=e),o),h((()=>r.updating),(()=>this.notifyChange(\"updating\")),o)],u)}this._updateHighlight()}else null!=this.layer.sublayers&&this.addHandles(a((()=>this.layer.sublayers),\"change\",(()=>this._createGraphicsViews()),{onListenerAdd:()=>this._createGraphicsViews(),onListenerRemove:()=>this._destroyGraphicsViews()}),d)}detach(){this._destroyGraphicsViews(),this.removeHandles(d)}moveStart(){}moveEnd(){}viewChange(){for(const e of this.graphicsViews())e.viewChange()}isUpdating(){for(const e of this.graphicsViews())if(e.updating)return!0;return!1}_destroyGraphicsViews(){this.container.removeAllChildren(),this.removeHandles(u);for(const e of this.graphicsViews())e.destroy();this._graphicsViews=null,this._graphicsViewsFeatureCollectionMap=null}_createGraphicsViews(){if(this._destroyGraphicsViews(),null==this.layer.sublayers)return;const e=[],i=this.view,s=()=>this.requestUpdate();for(const t of this.layer.sublayers){const r=new p(this.view.featuresTilingScheme);r.fadeTransitionEnabled=!0;const a=new c({view:i,graphics:t.graphics,requestUpdateCallback:s,container:r});this.addHandles([t.on(\"graphic-update\",a.graphicUpdateHandler),h((()=>t.visible),(e=>a.container.visible=e),o),h((()=>a.updating),(()=>this.notifyChange(\"updating\")),o)],u),this.container.addChild(a.container),e.push(a)}this._graphicsViews=e,this._updateHighlight()}_addHighlight(e){for(const i of e)if(this._highlightIds.has(i)){const e=this._highlightIds.get(i);this._highlightIds.set(i,e+1)}else this._highlightIds.set(i,1);this._updateHighlight()}_removeHighlight(e){for(const i of e)if(this._highlightIds.has(i)){const e=this._highlightIds.get(i)-1;0===e?this._highlightIds.delete(i):this._highlightIds.set(i,e)}this._updateHighlight()}_updateHighlight(){const e=Array.from(this._highlightIds.keys());for(const i of this.graphicsViews())i.setHighlight(e)}};f=e([l(\"esri.views.2d.layers.MapNotesLayerView2D\")],f);const m=f;export{m as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{WGLDrawPhase as e}from\"../../engine/webgl/enums.js\";import r from\"./BaseGraphicContainer.js\";class i extends r{renderChildren(r){this.attributeView.update(),this.children.some((e=>e.hasData))&&(this.attributeView.bindTextures(r.context,!1),super.renderChildren(r),r.drawPhase===e.MAP&&this._renderChildren(r),this.hasHighlight&&r.drawPhase===e.HIGHLIGHT&&this._renderHighlight(r),this._boundsRenderer&&this._boundsRenderer.doRender(r))}_renderHighlight(e){const{painter:r}=e,i=r.effects.highlight;i.bind(e),this._renderChildren(e,i.defines),i.draw(e),i.unbind()}}export{i as default};\n"],"names":["_","e","i","isSome","s","t","makeHandle","r","watch","h","on","a","initial","o","subclass","l","LayerView2DMixin","n","p","c","g","d","u","f","constructor","arguments","_highlightIds","Map","fetchPopupFeatures","Array","from","graphicsViews","hitTest","filter","popupTemplate","flat","_graphicsViewsFeatureCollectionMap","_graphicsViews","keys","get","sourceLayer","layer","map","type","graphic","mapPoint","highlight","uid","isArray","length","isCollection","toArray","_addHighlight","_removeHighlight","update","processUpdate","attach","view","requestUpdate","featureCollections","featuresTilingScheme","graphics","source","renderer","requestUpdateCallback","container","set","addChild","addHandles","visible","updating","notifyChange","_updateHighlight","sublayers","_createGraphicsViews","onListenerAdd","onListenerRemove","_destroyGraphicsViews","detach","removeHandles","moveStart","moveEnd","viewChange","isUpdating","removeAllChildren","destroy","fadeTransitionEnabled","graphicUpdateHandler","push","has","delete","setHighlight","m","default","WGLDrawPhase","renderChildren","attributeView","children","some","hasData","bindTextures","context","drawPhase","MAP","_renderChildren","hasHighlight","HIGHLIGHT","_renderHighlight","_boundsRenderer","doRender","painter","effects","bind","defines","draw","unbind"],"sourceRoot":"webpack:///","x_google_ignoreList":[0,1]}