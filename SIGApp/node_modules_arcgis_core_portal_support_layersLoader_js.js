"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["node_modules_arcgis_core_portal_support_layersLoader_js"],{

/***/ 21248:
/*!******************************************************************!*\
  !*** ./node_modules/@arcgis/core/portal/support/layersLoader.js ***!
  \******************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "load": () => (/* binding */ g)
/* harmony export */ });
/* harmony import */ var _home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../core/Error.js */ 32995);
/* harmony import */ var _layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../layers/support/arcgisLayerUrl.js */ 4583);
/* harmony import */ var _layers_support_fetchService_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../layers/support/fetchService.js */ 50714);
/* harmony import */ var _layers_support_LayerLoadContext_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../layers/support/LayerLoadContext.js */ 72756);
/* harmony import */ var _layers_support_layersCreator_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../layers/support/layersCreator.js */ 97174);
/* harmony import */ var _layers_support_lazyLayerLoader_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../layers/support/lazyLayerLoader.js */ 15392);
/* harmony import */ var _Portal_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../Portal.js */ 9058);
/* harmony import */ var _jsonContext_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ./jsonContext.js */ 45773);
/* harmony import */ var _loadUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ./loadUtils.js */ 33878);
/* harmony import */ var _portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./portalItemUtils.js */ 39712);
/* harmony import */ var _renderers_support_styleUtils_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ../../renderers/support/styleUtils.js */ 2929);
/* harmony import */ var _support_requestPresets_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../../support/requestPresets.js */ 2013);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/












function g(_x, _x2) {
  return _g.apply(this, arguments);
}
function _g() {
  _g = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t) {
    const r = e.instance.portalItem;
    if (r?.id) return yield r.load(t), I(e), L(e, t);
  });
  return _g.apply(this, arguments);
}
function I(t) {
  const r = t.instance.portalItem;
  if (!r?.type || !t.supportedTypes.includes(r.type)) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("portal:invalid-layer-item-type", "Invalid layer item type '${type}', expected '${expectedType}'", {
    type: r?.type,
    expectedType: t.supportedTypes.join(", ")
  });
}
function L(_x3, _x4) {
  return _L.apply(this, arguments);
}
function _L() {
  _L = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t) {
    const r = e.instance,
      n = r.portalItem;
    if (!n) return;
    const {
        url: o,
        title: s
      } = n,
      i = (0,_jsonContext_js__WEBPACK_IMPORTED_MODULE_8__.createForItemRead)(n);
    if ("group" === r.type) return S(r, i, e);
    o && r.read({
      url: o
    }, i);
    const p = new _layers_support_LayerLoadContext_js__WEBPACK_IMPORTED_MODULE_4__.LayerLoadContext(),
      u = yield F(e, p, t);
    return u && r.read(u, i), r.resourceReferences = {
      portalItem: n,
      paths: i.readResourcePaths ?? []
    }, "subtype-group" !== r.type && r.read({
      title: s
    }, i), (0,_renderers_support_styleUtils_js__WEBPACK_IMPORTED_MODULE_11__.loadStyleRenderer)(r, i);
  });
  return _L.apply(this, arguments);
}
function S(_x5, _x6, _x7) {
  return _S.apply(this, arguments);
}
function _S() {
  _S = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (t, r, a) {
    const n = t.portalItem;
    if (!t.sourceIsPortalItem) return;
    const {
      title: o,
      type: s
    } = n;
    if ("Group Layer" === s) {
      if (!(0,_portalItemUtils_js__WEBPACK_IMPORTED_MODULE_10__.hasTypeKeyword)(n, "Map")) throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("portal:invalid-layer-item-typekeyword", "'Group Layer' item without 'Map' type keyword is not supported");
      return T(t);
    }
    return t.read({
      title: o
    }, r), j(t, a);
  });
  return _S.apply(this, arguments);
}
function T(_x8) {
  return _T.apply(this, arguments);
}
function _T() {
  _T = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e) {
    const t = e.portalItem,
      r = yield t.fetchData("json");
    if (!r) return;
    const a = (0,_jsonContext_js__WEBPACK_IMPORTED_MODULE_8__.createForGroupLayerItemRead)(t);
    e.read(r, a), yield (0,_layers_support_layersCreator_js__WEBPACK_IMPORTED_MODULE_5__.populateGroupLayer)(e, r, {
      context: a
    }), e.resourceReferences = {
      portalItem: t,
      paths: a.readResourcePaths ?? []
    };
  });
  return _T.apply(this, arguments);
}
function j(_x9, _x10) {
  return _j.apply(this, arguments);
}
function _j() {
  _j = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (t, r) {
    let n;
    const {
      portalItem: o
    } = t;
    if (!o) return;
    const s = o.type,
      l = r.layerModuleTypeMap;
    switch (s) {
      case "Feature Service":
      case "Feature Collection":
        n = l.FeatureLayer;
        break;
      case "Stream Service":
        n = l.StreamLayer;
        break;
      case "Scene Service":
        n = l.SceneLayer;
        break;
      default:
        throw new _core_Error_js__WEBPACK_IMPORTED_MODULE_1__["default"]("portal:unsupported-item-type-as-group", `The item type '${s}' is not supported as a 'IGroupLayer'`);
    }
    const i = new _layers_support_LayerLoadContext_js__WEBPACK_IMPORTED_MODULE_4__.LayerLoadContext();
    let [d, m] = yield Promise.all([n(), F(r, i)]),
      h = () => d;
    if ("Feature Service" === s) {
      m = o.url ? yield (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.preprocessFSItemData)(m, o.url, i) : {};
      const e = (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getSubtypeGroupLayerIds)(m),
        r = (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getOrientedImageryLayerIds)(m),
        a = [];
      if (e.length || r?.length) {
        e.length && a.push("SubtypeGroupLayer"), r?.length && a.push("OrientedImageryLayer");
        const t = [];
        for (const e of a) {
          const r = l[e];
          t.push(r());
        }
        const n = yield Promise.all(t),
          o = new Map();
        a.forEach((e, t) => {
          o.set(e, n[t]);
        }), h = e => e.layerType ? o.get(e.layerType) ?? d : d;
      }
      const n = yield E(o.url);
      return yield M(t, h, m, n);
    }
    return "Scene Service" === s && o.url && (m = yield (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.populateSceneServiceItemData)(o, m, i)), (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getNumLayersAndTables)(m) > 0 ? yield M(t, h, m) : yield v(t, h);
  });
  return _j.apply(this, arguments);
}
function v(_x11, _x12) {
  return _v.apply(this, arguments);
}
function _v() {
  _v = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t) {
    const {
      portalItem: r
    } = e;
    if (!r?.url) return;
    const a = yield (0,_support_requestPresets_js__WEBPACK_IMPORTED_MODULE_12__.fetchArcGISServiceJSON)(r.url);
    a && M(e, t, {
      layers: a.layers?.map(_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.createSublayerData),
      tables: a.tables?.map(_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.createSublayerData)
    });
  });
  return _v.apply(this, arguments);
}
function M(_x13, _x14, _x15, _x16) {
  return _M.apply(this, arguments);
}
function _M() {
  _M = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t, r, a) {
    let n = r.layers || [];
    const s = r.tables || [];
    if ("Feature Collection" === e.portalItem?.type ? (n.forEach((e, t) => {
      e.id = t, "Table" === e?.layerDefinition?.type && s.push(e);
    }), n = n.filter(e => "Table" !== e?.layerDefinition?.type)) : (n.reverse(), s.reverse()), n.forEach(n => {
      const o = a?.(n);
      if (o || !a) {
        const a = x(e, t(n), r, n, o);
        e.add(a);
      }
    }), s.length) {
      const t = yield _layers_support_lazyLayerLoader_js__WEBPACK_IMPORTED_MODULE_6__.layerLookupMap.FeatureLayer();
      s.forEach(n => {
        const o = a?.(n);
        if (o || !a) {
          const a = x(e, t, r, n, o);
          e.tables.add(a);
        }
      });
    }
  });
  return _M.apply(this, arguments);
}
function x(e, t, r, a, n) {
  const o = e.portalItem,
    l = {
      portalItem: o.clone(),
      layerId: a.id
    };
  null != a.url && (l.url = a.url);
  const i = new t(l);
  if ("sourceJSON" in i && (i.sourceJSON = n), "subtype-group" !== i.type && (i.sublayerTitleMode = "service-name"), "Feature Collection" === o.type) {
    const e = {
      origin: "portal-item",
      portal: o.portal || _Portal_js__WEBPACK_IMPORTED_MODULE_7__["default"].getDefault()
    };
    i.read(a, e);
    const t = r.showLegend;
    null != t && i.read({
      showLegend: t
    }, e);
  }
  return i;
}
function F(_x17, _x18, _x19) {
  return _F.apply(this, arguments);
}
function _F() {
  _F = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, t, r) {
    if (!1 === e.supportsData) return;
    const a = e.instance,
      n = a.portalItem;
    if (!n) return;
    let o = null;
    try {
      o = yield n.fetchData("json", r);
    } catch (s) {}
    if (D(a)) {
      let e = null;
      const r = yield P(n, o, t);
      if ((o?.layers || o?.tables) && r > 0) {
        if (null == a.layerId) {
          const e = (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getSubtypeGroupLayerIds)(o);
          a.layerId = "subtype-group" === a.type ? e?.[0] : (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getFirstLayerOrTableId)(o);
        }
        e = C(o, a), e && null != o.showLegend && (e.showLegend = o.showLegend);
      }
      return r > 1 && "sublayerTitleMode" in a && "service-name" !== a.sublayerTitleMode && (a.sublayerTitleMode = "item-title-and-service-name"), e;
    }
    return o;
  });
  return _F.apply(this, arguments);
}
function P(_x20, _x21, _x22) {
  return _P.apply(this, arguments);
}
function _P() {
  _P = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e, r, a) {
    if (r?.layers && r?.tables) return (0,_loadUtils_js__WEBPACK_IMPORTED_MODULE_9__.getNumLayersAndTables)(r);
    const n = (0,_layers_support_arcgisLayerUrl_js__WEBPACK_IMPORTED_MODULE_2__.parse)(e.url);
    if (!n) return 1;
    const o = yield a.fetchServiceMetadata(n.url.path).catch(() => null);
    return (r?.layers?.length ?? o?.layers?.length ?? 0) + (r?.tables?.length ?? o?.tables?.length ?? 0);
  });
  return _P.apply(this, arguments);
}
function C(e, t) {
  const {
      layerId: r
    } = t,
    a = e.layers?.find(e => e.id === r) || e.tables?.find(e => e.id === r);
  return a && k(a, t) ? a : null;
}
function D(e) {
  return "stream" !== e.type && "layerId" in e;
}
function k(e, t) {
  return !("feature" === t.type && "layerType" in e && "SubtypeGroupLayer" === e.layerType || "subtype-group" === t.type && !("layerType" in e));
}
function E(_x23) {
  return _E.apply(this, arguments);
}
function _E() {
  _E = (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* (e) {
    const {
      layersJSON: t
    } = yield (0,_layers_support_fetchService_js__WEBPACK_IMPORTED_MODULE_3__.fetchFeatureService)(e);
    if (!t) return null;
    const a = [...t.layers, ...t.tables];
    return e => a.find(t => t.id === e.id);
  });
  return _E.apply(this, arguments);
}


/***/ })

}]);
//# sourceMappingURL=node_modules_arcgis_core_portal_support_layersLoader_js.js.map