{"version":3,"file":"node_modules_arcgis_core_views_2d_layers_features_processors_HeatmapProcessor_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js","./node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport{_ as e}from\"../../../../../chunks/tslib.es6.js\";import\"../../../../../core/has.js\";import\"../../../../../core/Logger.js\";import\"../../../../../core/accessorSupport/ensureType.js\";import\"../../../../../core/arrayUtils.js\";import\"../../../../../core/Error.js\";import{subclass as t}from\"../../../../../core/accessorSupport/decorators/subclass.js\";import{diff as s}from\"../../../../../core/accessorSupport/diffUtils.js\";import{calculateHeatmapIntensityInfoReaders as r}from\"../../../../../renderers/support/heatmapUtils.js\";import{tileSize as i}from\"../../../engine/webgl/definitions.js\";import o from\"./BaseProcessor.js\";import{getPow2NeighborKey as a}from\"../support/tileUtils.js\";class n{constructor(e,t){this.offset=e,this.extent=t}}function d(e){const t=e.key,s=new Map,r=256,o=i,d=e.tileInfoView.tileInfo.isWrappable;return s.set(a(t,-1,-1,d).id,new n([-o,-o],[o-r,o-r,o,o])),s.set(a(t,0,-1,d).id,new n([0,-o],[0,o-r,o,o])),s.set(a(t,1,-1,d).id,new n([o,-o],[0,o-r,r,o])),s.set(a(t,-1,0,d).id,new n([-o,0],[o-r,0,o,o])),s.set(a(t,1,0,d).id,new n([o,0],[0,0,r,o])),s.set(a(t,-1,1,d).id,new n([-o,o],[o-r,0,o,r])),s.set(a(t,0,1,d).id,new n([0,o],[0,0,o,r])),s.set(a(t,1,1,d).id,new n([o,o],[0,0,r,r])),s}let l=class extends o{constructor(){super(...arguments),this.type=\"heatmap\",this._tileKeyToFeatureSets=new Map}initialize(){this.addHandles([this.tileStore.on(\"update\",this.onTileUpdate.bind(this))])}async update(e,t){const r=t.schema.processors[0];if(\"heatmap\"!==r.type)return;s(this._schema,r)&&(e.mesh=!0,this._schema=r)}onTileUpdate(e){for(const t of e.removed)this._tileKeyToFeatureSets.delete(t.key.id)}onTileClear(e){const t={clear:!0};return this._tileKeyToFeatureSets.delete(e.key.id),this.remoteClient.invoke(\"tileRenderer.onTileData\",{tileKey:e.id,data:t})}async onTileMessage(e,t,s){this._tileKeyToFeatureSets.has(e.key.id)||this._tileKeyToFeatureSets.set(e.key.id,new Map);const i=this._tileKeyToFeatureSets.get(e.key.id);if(i&&null!=t.addOrUpdate&&t.addOrUpdate.hasFeatures&&i.set(t.addOrUpdate.instance,t),t.end){const t=[],i=d(e);this._tileKeyToFeatureSets.forEach(((s,r)=>{if(r===e.key.id)s.forEach((({addOrUpdate:e})=>{e&&t.push(e)}));else if(i.has(r)){const e=i.get(r),[o,a]=e.offset;s.forEach((({addOrUpdate:e})=>{if(e){const s=e.transform(o,a,1,1);t.push(s)}}))}}));const o=r(t,this._schema.mesh,512,512),a={tileKey:e.key.id,intensityInfo:o},n=[o.matrix];return this.remoteClient.invoke(\"tileRenderer.onTileData\",a,{...s,transferList:n})}}onTileError(e,t,s){return this.remoteClient.invoke(\"tileRenderer.onTileError\",{tileKey:e.id,error:t},s)}};l=e([t(\"esri.views.2d.layers.features.processors.HeatmapProcessor\")],l);const p=l;export{p as default};\n","/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nfunction o(o,l,c,r){const e=o.clone(),n=1<<e.level,t=e.col+l,w=e.row+c;return r&&t<0?(e.col=t+n,e.world-=1):t>=n?(e.col=t-n,e.world+=1):e.col=t,e.row=w,e}export{o as getPow2NeighborKey};\n"],"names":["_","e","subclass","t","diff","s","calculateHeatmapIntensityInfoReaders","r","tileSize","i","o","getPow2NeighborKey","a","n","constructor","offset","extent","d","key","Map","tileInfoView","tileInfo","isWrappable","set","id","l","arguments","type","_tileKeyToFeatureSets","initialize","addHandles","tileStore","on","onTileUpdate","bind","update","schema","processors","_schema","mesh","removed","delete","onTileClear","clear","remoteClient","invoke","tileKey","data","onTileMessage","has","get","addOrUpdate","hasFeatures","instance","end","forEach","push","transform","intensityInfo","matrix","transferList","onTileError","error","p","default","c","clone","level","col","w","row","world"],"sourceRoot":"webpack:///","x_google_ignoreList":[0,1]}