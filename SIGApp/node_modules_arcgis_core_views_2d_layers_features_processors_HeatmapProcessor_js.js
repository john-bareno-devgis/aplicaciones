"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["node_modules_arcgis_core_views_2d_layers_features_processors_HeatmapProcessor_js"],{

/***/ 70113:
/*!*******************************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/processors/HeatmapProcessor.js ***!
  \*******************************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ p)
/* harmony export */ });
/* harmony import */ var _home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../../../chunks/tslib.es6.js */ 18100);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../../../core/has.js */ 67087);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../../../core/Logger.js */ 28191);
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../../../core/accessorSupport/ensureType.js */ 83382);
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../../../core/arrayUtils.js */ 19420);
/* harmony import */ var _core_Error_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../../../core/Error.js */ 32995);
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../../../core/accessorSupport/decorators/subclass.js */ 20891);
/* harmony import */ var _core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../../../core/accessorSupport/diffUtils.js */ 51118);
/* harmony import */ var _renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../../../renderers/support/heatmapUtils.js */ 45811);
/* harmony import */ var _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ../../../engine/webgl/definitions.js */ 80696);
/* harmony import */ var _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./BaseProcessor.js */ 38672);
/* harmony import */ var _support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ../support/tileUtils.js */ 65342);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/












class n {
  constructor(e, t) {
    this.offset = e, this.extent = t;
  }
}
function d(e) {
  const t = e.key,
    s = new Map(),
    r = 256,
    o = _engine_webgl_definitions_js__WEBPACK_IMPORTED_MODULE_10__.tileSize,
    d = e.tileInfoView.tileInfo.isWrappable;
  return s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, -1, -1, d).id, new n([-o, -o], [o - r, o - r, o, o])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, 0, -1, d).id, new n([0, -o], [0, o - r, o, o])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, 1, -1, d).id, new n([o, -o], [0, o - r, r, o])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, -1, 0, d).id, new n([-o, 0], [o - r, 0, o, o])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, 1, 0, d).id, new n([o, 0], [0, 0, r, o])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, -1, 1, d).id, new n([-o, o], [o - r, 0, o, r])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, 0, 1, d).id, new n([0, o], [0, 0, o, r])), s.set((0,_support_tileUtils_js__WEBPACK_IMPORTED_MODULE_12__.getPow2NeighborKey)(t, 1, 1, d).id, new n([o, o], [0, 0, r, r])), s;
}
let l = class extends _BaseProcessor_js__WEBPACK_IMPORTED_MODULE_11__["default"] {
  constructor() {
    super(...arguments), this.type = "heatmap", this._tileKeyToFeatureSets = new Map();
  }
  initialize() {
    this.addHandles([this.tileStore.on("update", this.onTileUpdate.bind(this))]);
  }
  update(e, t) {
    var _this = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const r = t.schema.processors[0];
      if ("heatmap" !== r.type) return;
      (0,_core_accessorSupport_diffUtils_js__WEBPACK_IMPORTED_MODULE_8__.diff)(_this._schema, r) && (e.mesh = !0, _this._schema = r);
    })();
  }
  onTileUpdate(e) {
    for (const t of e.removed) this._tileKeyToFeatureSets.delete(t.key.id);
  }
  onTileClear(e) {
    const t = {
      clear: !0
    };
    return this._tileKeyToFeatureSets.delete(e.key.id), this.remoteClient.invoke("tileRenderer.onTileData", {
      tileKey: e.id,
      data: t
    });
  }
  onTileMessage(e, t, s) {
    var _this2 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      _this2._tileKeyToFeatureSets.has(e.key.id) || _this2._tileKeyToFeatureSets.set(e.key.id, new Map());
      const i = _this2._tileKeyToFeatureSets.get(e.key.id);
      if (i && null != t.addOrUpdate && t.addOrUpdate.hasFeatures && i.set(t.addOrUpdate.instance, t), t.end) {
        const t = [],
          i = d(e);
        _this2._tileKeyToFeatureSets.forEach((s, r) => {
          if (r === e.key.id) s.forEach(({
            addOrUpdate: e
          }) => {
            e && t.push(e);
          });else if (i.has(r)) {
            const e = i.get(r),
              [o, a] = e.offset;
            s.forEach(({
              addOrUpdate: e
            }) => {
              if (e) {
                const s = e.transform(o, a, 1, 1);
                t.push(s);
              }
            });
          }
        });
        const o = (0,_renderers_support_heatmapUtils_js__WEBPACK_IMPORTED_MODULE_9__.calculateHeatmapIntensityInfoReaders)(t, _this2._schema.mesh, 512, 512),
          a = {
            tileKey: e.key.id,
            intensityInfo: o
          },
          n = [o.matrix];
        return _this2.remoteClient.invoke("tileRenderer.onTileData", a, {
          ...s,
          transferList: n
        });
      }
    })();
  }
  onTileError(e, t, s) {
    return this.remoteClient.invoke("tileRenderer.onTileError", {
      tileKey: e.id,
      error: t
    }, s);
  }
};
l = (0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_1__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_7__.subclass)("esri.views.2d.layers.features.processors.HeatmapProcessor")], l);
const p = l;


/***/ }),

/***/ 65342:
/*!*********************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/features/support/tileUtils.js ***!
  \*********************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "getPow2NeighborKey": () => (/* binding */ o)
/* harmony export */ });
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/
function o(o, l, c, r) {
  const e = o.clone(),
    n = 1 << e.level,
    t = e.col + l,
    w = e.row + c;
  return r && t < 0 ? (e.col = t + n, e.world -= 1) : t >= n ? (e.col = t - n, e.world += 1) : e.col = t, e.row = w, e;
}


/***/ })

}]);
//# sourceMappingURL=node_modules_arcgis_core_views_2d_layers_features_processors_HeatmapProcessor_js.js.map