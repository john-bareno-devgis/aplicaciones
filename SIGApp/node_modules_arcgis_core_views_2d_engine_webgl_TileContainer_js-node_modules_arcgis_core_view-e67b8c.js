"use strict";
(self["webpackChunkrealgis"] = self["webpackChunkrealgis"] || []).push([["node_modules_arcgis_core_views_2d_engine_webgl_TileContainer_js-node_modules_arcgis_core_view-e67b8c"],{

/***/ 53971:
/*!**************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/TileContainer.js ***!
  \**************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ i)
/* harmony export */ });
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../core/has.js */ 67087);
/* harmony import */ var _enums_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./enums.js */ 20753);
/* harmony import */ var _WGLContainer_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./WGLContainer.js */ 98694);
/* harmony import */ var _brushes_WGLBrushInfo_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./brushes/WGLBrushInfo.js */ 26877);
/* harmony import */ var _brushes_WGLBrushStencil_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ./brushes/WGLBrushStencil.js */ 67135);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/





const n = (e, r) => e.key.level - r.key.level != 0 ? e.key.level - r.key.level : e.key.row - r.key.row != 0 ? e.key.row - r.key.row : e.key.col - r.key.col;
class i extends _WGLContainer_js__WEBPACK_IMPORTED_MODULE_2__["default"] {
  constructor(e) {
    super(), this._tileInfoView = e;
  }
  renderChildren(e) {
    this.sortChildren(n), this.setStencilReference(e), super.renderChildren(e);
  }
  createRenderParams(e) {
    const {
        state: r
      } = e,
      s = super.createRenderParams(e);
    return s.requiredLevel = this._tileInfoView.getClosestInfoForScale(r.scale).level, s.displayLevel = this._tileInfoView.tileInfo.scaleToZoom(r.scale), s;
  }
  prepareRenderPasses(r) {
    const n = super.prepareRenderPasses(r);
    return n.push(r.registerRenderPass({
      name: "stencil",
      brushes: [_brushes_WGLBrushStencil_js__WEBPACK_IMPORTED_MODULE_4__["default"]],
      drawPhase: _enums_js__WEBPACK_IMPORTED_MODULE_1__.WGLDrawPhase.DEBUG | _enums_js__WEBPACK_IMPORTED_MODULE_1__.WGLDrawPhase.MAP | _enums_js__WEBPACK_IMPORTED_MODULE_1__.WGLDrawPhase.HIGHLIGHT,
      target: () => this.getStencilTarget()
    })), (0,_core_has_js__WEBPACK_IMPORTED_MODULE_0__["default"])("esri-tiles-debug") && n.push(r.registerRenderPass({
      name: "tileInfo",
      brushes: [_brushes_WGLBrushInfo_js__WEBPACK_IMPORTED_MODULE_3__["default"]],
      drawPhase: _enums_js__WEBPACK_IMPORTED_MODULE_1__.WGLDrawPhase.DEBUG,
      target: () => this.children
    })), n;
  }
  getStencilTarget() {
    return this.children;
  }
  setStencilReference(e) {
    let r = 1;
    for (const s of this.children) s.stencilRef = r++;
  }
}


/***/ }),

/***/ 11653:
/*!*******************************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/engine/webgl/TiledDisplayObject.js ***!
  \*******************************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "TiledDisplayObject": () => (/* binding */ r)
/* harmony export */ });
/* harmony import */ var _chunks_mat3_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ../../../../chunks/mat3.js */ 38974);
/* harmony import */ var _DisplayObject_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../DisplayObject.js */ 99390);
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../tiling/TileKey.js */ 67026);
/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/



class r extends _DisplayObject_js__WEBPACK_IMPORTED_MODULE_1__.DisplayObject {
  constructor(t, s, i, r, h, o, n = h, a = o) {
    super(), this.triangleCountReportedInDebug = 0, this.triangleCount = 0, this.texture = null, this.key = new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_2__["default"](t), this.resolution = s, this.x = i, this.y = r, this.width = h, this.height = o, this.rangeX = n, this.rangeY = a;
  }
  destroy() {
    this.texture && (this.texture.dispose(), this.texture = null);
  }
  setTransform(i) {
    const e = this.resolution / (i.resolution * i.pixelRatio),
      r = this.transforms.tileMat3,
      [h, o] = i.toScreenNoRotation([0, 0], [this.x, this.y]),
      n = this.width / this.rangeX * e,
      a = this.height / this.rangeY * e;
    (0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_0__.s)(r, n, 0, 0, 0, a, 0, h, o, 1), (0,_chunks_mat3_js__WEBPACK_IMPORTED_MODULE_0__.m)(this.transforms.dvs, i.displayViewMat3, r);
  }
}


/***/ }),

/***/ 54728:
/*!**********************************************************************!*\
  !*** ./node_modules/@arcgis/core/views/2d/layers/WMTSLayerView2D.js ***!
  \**********************************************************************/
/***/ ((__unused_webpack___webpack_module__, __webpack_exports__, __webpack_require__) => {

__webpack_require__.r(__webpack_exports__);
/* harmony export */ __webpack_require__.d(__webpack_exports__, {
/* harmony export */   "default": () => (/* binding */ w)
/* harmony export */ });
/* harmony import */ var _home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js */ 71670);
/* harmony import */ var _chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ../../../chunks/tslib.es6.js */ 18100);
/* harmony import */ var _core_Logger_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ../../../core/Logger.js */ 28191);
/* harmony import */ var _core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../../core/promiseUtils.js */ 30801);
/* harmony import */ var _core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/property.js */ 9497);
/* harmony import */ var _core_accessorSupport_ensureType_js__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! ../../../core/accessorSupport/ensureType.js */ 83382);
/* harmony import */ var _core_arrayUtils_js__WEBPACK_IMPORTED_MODULE_6__ = __webpack_require__(/*! ../../../core/arrayUtils.js */ 19420);
/* harmony import */ var _core_has_js__WEBPACK_IMPORTED_MODULE_7__ = __webpack_require__(/*! ../../../core/has.js */ 67087);
/* harmony import */ var _core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__ = __webpack_require__(/*! ../../../core/accessorSupport/decorators/subclass.js */ 20891);
/* harmony import */ var _geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_9__ = __webpack_require__(/*! ../../../geometry/support/spatialReferenceUtils.js */ 53492);
/* harmony import */ var _BitmapTileLayerView2D_js__WEBPACK_IMPORTED_MODULE_10__ = __webpack_require__(/*! ./BitmapTileLayerView2D.js */ 41699);
/* harmony import */ var _LayerView2D_js__WEBPACK_IMPORTED_MODULE_11__ = __webpack_require__(/*! ./LayerView2D.js */ 49322);
/* harmony import */ var _support_imageUtils_js__WEBPACK_IMPORTED_MODULE_12__ = __webpack_require__(/*! ./support/imageUtils.js */ 20987);
/* harmony import */ var _tiling_TileInfoView_js__WEBPACK_IMPORTED_MODULE_13__ = __webpack_require__(/*! ../tiling/TileInfoView.js */ 3795);
/* harmony import */ var _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_14__ = __webpack_require__(/*! ../tiling/TileKey.js */ 67026);
/* harmony import */ var _tiling_TileQueue_js__WEBPACK_IMPORTED_MODULE_15__ = __webpack_require__(/*! ../tiling/TileQueue.js */ 90026);
/* harmony import */ var _tiling_TileStrategy_js__WEBPACK_IMPORTED_MODULE_16__ = __webpack_require__(/*! ../tiling/TileStrategy.js */ 97836);
/* harmony import */ var _layers_LayerView_js__WEBPACK_IMPORTED_MODULE_17__ = __webpack_require__(/*! ../../layers/LayerView.js */ 3589);
/* harmony import */ var _layers_RefreshableLayerView_js__WEBPACK_IMPORTED_MODULE_18__ = __webpack_require__(/*! ../../layers/RefreshableLayerView.js */ 34040);

/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.28/esri/copyright.txt for details.
*/


















const d = new Set([102113, 102100, 3857, 3785, 900913]),
  y = [0, 0];
let _ = class extends (0,_layers_RefreshableLayerView_js__WEBPACK_IMPORTED_MODULE_18__["default"])((0,_BitmapTileLayerView2D_js__WEBPACK_IMPORTED_MODULE_10__.BitmapTileLayerView2D)((0,_LayerView2D_js__WEBPACK_IMPORTED_MODULE_11__.LayerView2DMixin)(_layers_LayerView_js__WEBPACK_IMPORTED_MODULE_17__["default"]))) {
  constructor() {
    super(...arguments), this._tileStrategy = null, this._fetchQueue = null, this.layer = null;
  }
  get tileMatrixSet() {
    const e = this._getTileMatrixSetBySpatialReference(this.layer.activeLayer);
    return e ? (e.id !== this.layer.activeLayer.tileMatrixSetId && (this.layer.activeLayer.tileMatrixSetId = e.id), e) : null;
  }
  update(e) {
    this._fetchQueue.pause(), this._fetchQueue.state = e.state, this._tileStrategy.update(e), this._fetchQueue.resume();
  }
  attach() {
    const e = this.tileMatrixSet?.tileInfo;
    e && (this._tileInfoView = new _tiling_TileInfoView_js__WEBPACK_IMPORTED_MODULE_13__["default"](e), this._fetchQueue = new _tiling_TileQueue_js__WEBPACK_IMPORTED_MODULE_15__["default"]({
      tileInfoView: this._tileInfoView,
      concurrency: 16,
      process: (e, t) => this.fetchTile(e, t)
    }), this._tileStrategy = new _tiling_TileStrategy_js__WEBPACK_IMPORTED_MODULE_16__["default"]({
      cachePolicy: "keep",
      resampling: !0,
      acquireTile: e => this.acquireTile(e),
      releaseTile: e => this.releaseTile(e),
      tileInfoView: this._tileInfoView
    }), this.addAttachHandles(this._updatingHandles.add(() => [this.layer?.activeLayer?.styleId, this.tileMatrixSet], () => this.doRefresh())), super.attach());
  }
  detach() {
    super.detach(), this._tileStrategy?.destroy(), this._fetchQueue?.destroy(), this._fetchQueue = this._tileStrategy = this._tileInfoView = null;
  }
  moveStart() {
    this.requestUpdate();
  }
  viewChange() {
    this.requestUpdate();
  }
  moveEnd() {
    this.requestUpdate();
  }
  supportsSpatialReference(e) {
    return this.layer.activeLayer.tileMatrixSets?.some(t => (0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_9__.equals)(t.tileInfo?.spatialReference, e)) ?? !1;
  }
  doRefresh() {
    var _this = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      if (_this.attached) {
        if (_this.suspended) return _this._tileStrategy.clear(), void _this.requestUpdate();
        _this._fetchQueue.reset(), _this._tileStrategy.refresh(e => _this._updatingHandles.addPromise(_this._enqueueTileFetch(e)));
      }
    })();
  }
  acquireTile(e) {
    const t = this._bitmapView.createTile(e),
      i = t.bitmap;
    return [i.x, i.y] = this._tileInfoView.getTileCoords(y, t.key), i.resolution = this._tileInfoView.getTileResolution(t.key), [i.width, i.height] = this._tileInfoView.tileInfo.size, this._updatingHandles.addPromise(this._enqueueTileFetch(t)), this._bitmapView.addChild(t), this.requestUpdate(), t;
  }
  releaseTile(e) {
    this._fetchQueue.abort(e.key.id), this._bitmapView.removeChild(e), e.once("detach", () => e.destroy()), this.requestUpdate();
  }
  fetchTile(e, t = {}) {
    var _this2 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      const s = "tilemapCache" in _this2.layer ? _this2.layer.tilemapCache : null,
        {
          signal: r,
          resamplingLevel: a = 0
        } = t;
      if (!s) return _this2._fetchImage(e, r);
      const l = new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_14__["default"](0, 0, 0, 0);
      let o;
      try {
        yield s.fetchAvailabilityUpsample(e.level, e.row, e.col, l, {
          signal: r
        }), o = yield _this2._fetchImage(l, r);
      } catch (n) {
        if ((0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.isAbortError)(n)) throw n;
        if (a < 3) {
          const i = _this2._tileInfoView.getTileParentId(e.id);
          if (i) {
            const s = new _tiling_TileKey_js__WEBPACK_IMPORTED_MODULE_14__["default"](i),
              r = yield _this2.fetchTile(s, {
                ...t,
                resamplingLevel: a + 1
              });
            return (0,_support_imageUtils_js__WEBPACK_IMPORTED_MODULE_12__.resampleImage)(_this2._tileInfoView, r, s, e);
          }
        }
        throw n;
      }
      return (0,_support_imageUtils_js__WEBPACK_IMPORTED_MODULE_12__.resampleImage)(_this2._tileInfoView, o, l, e);
    })();
  }
  canResume() {
    const e = super.canResume();
    return e ? null !== this.tileMatrixSet : e;
  }
  _enqueueTileFetch(e) {
    var _this3 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      if (!_this3._fetchQueue.has(e.key.id)) {
        try {
          const t = yield _this3._fetchQueue.push(e.key);
          e.bitmap.source = t, e.bitmap.width = _this3._tileInfoView.tileInfo.size[0], e.bitmap.height = _this3._tileInfoView.tileInfo.size[1], e.once("attach", () => _this3.requestUpdate());
        } catch (s) {
          (0,_core_promiseUtils_js__WEBPACK_IMPORTED_MODULE_3__.isAbortError)(s) || _core_Logger_js__WEBPACK_IMPORTED_MODULE_2__["default"].getLogger(_this3).error(s);
        }
        _this3.requestUpdate();
      }
    })();
  }
  _fetchImage(e, t) {
    var _this4 = this;
    return (0,_home_ohnj_Documentos_realG4Life_1_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__["default"])(function* () {
      return _this4.layer.fetchImageBitmapTile(e.level, e.row, e.col, {
        signal: t
      });
    })();
  }
  _getTileMatrixSetBySpatialReference(e) {
    const t = this.view.spatialReference;
    if (!e.tileMatrixSets) return null;
    let i = e.tileMatrixSets.find(e => (0,_geometry_support_spatialReferenceUtils_js__WEBPACK_IMPORTED_MODULE_9__.equals)(e.tileInfo?.spatialReference, t));
    return !i && t.isWebMercator && (i = e.tileMatrixSets.find(e => d.has(e.tileInfo?.spatialReference.wkid ?? -1))), i;
  }
};
(0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_1__._)([(0,_core_accessorSupport_decorators_property_js__WEBPACK_IMPORTED_MODULE_4__.property)({
  readOnly: !0
})], _.prototype, "tileMatrixSet", null), _ = (0,_chunks_tslib_es6_js__WEBPACK_IMPORTED_MODULE_1__._)([(0,_core_accessorSupport_decorators_subclass_js__WEBPACK_IMPORTED_MODULE_8__.subclass)("esri.views.2d.layers.WMTSLayerView2D")], _);
const w = _;


/***/ })

}]);
//# sourceMappingURL=node_modules_arcgis_core_views_2d_engine_webgl_TileContainer_js-node_modules_arcgis_core_view-e67b8c.js.map