{"version":3,"file":"node_modules_arcgis_core_layers_support_labelFormatUtils_js.js","mappings":"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","sources":["./node_modules/@arcgis/core/layers/support/labelFormatUtils.js"],"sourcesContent":["/*\nAll material copyright ESRI, All Rights Reserved, unless otherwise specified.\nSee https://js.arcgis.com/4.28/esri/copyright.txt for details.\n*/\nimport e from\"../../core/Error.js\";import r from\"../../core/Logger.js\";import{parseWhereClause as t}from\"../../core/sql.js\";import{formatDate as n,convertDateFormatToIntlOptions as o}from\"../../intl/date.js\";import{formatNumber as a}from\"../../intl/number.js\";import{getDomainRange as l}from\"./domainUtils.js\";import{isDateField as i,isNumericField as s}from\"./fieldUtils.js\";import{getLabelExpression as u,getSingleFieldArcadeExpression as c}from\"./labelUtils.js\";import{createLabelExpression as f}from\"../../support/arcadeOnDemand.js\";const m=r.getLogger(\"esri.layers.support.labelFormatUtils\"),p={type:\"simple\",evaluate:()=>null},d={getAttribute:(e,r)=>e.field(r)};async function w(r,n,o){if(!r||!r.symbol||!n)return p;const a=r.where,l=u(r);let i;if(\"arcade\"===l.type){const r=await f(l.expression,o,n);if(null==r)return p;i={type:\"arcade\",evaluate(t,n){try{const e=\"attributes\"in t?r.repurposeFeature(t):t;e.contextTimeZone=n??null;const o=r.evaluate({$view:{timeZone:n},$feature:e},r.services);if(null!=o)return o.toString()}catch(o){m.error(new e(\"arcade-expression-error\",\"Encountered an error when evaluating label expression for feature\",{error:o,feature:t,expression:l}))}return null},needsHydrationToEvaluate:()=>null==c(l.expression)}}else i={type:\"simple\",evaluate:e=>l.expression.replaceAll(/{[^}]*}/g,(r=>{const t=r.slice(1,-1),o=n.get(t);if(!o)return r;let a=null;if(\"attributes\"in e){e&&e.attributes&&(a=e.attributes[o.name])}else a=e.field(o.name);return null==a?\"\":g(a,o)}))};if(a){let r;try{r=await t(a,n)}catch(s){return m.error(new e(\"bad-where-clause\",\"Encountered an error when evaluating where clause, ignoring\",{where:a,error:s})),p}const o=i.evaluate;i.evaluate=(t,n)=>{const l=\"attributes\"in t?void 0:d;try{if(r.testFeature(t,l))return o(t,n)}catch(s){m.error(new e(\"bad-where-clause\",\"Encountered an error when evaluating where clause for feature\",{where:a,feature:t,error:s}))}return null}}return i}function g(e,r){if(null==e)return\"\";const t=r.domain;if(t)if(\"codedValue\"===t.type||\"coded-value\"===t.type){const r=e;for(const e of t.codedValues)if(e.code===r)return e.name}else if(\"range\"===t.type){const{max:n,min:o}=l(r),a=+e;if(null!=o&&null!=n&&o<=a&&a<=n)return t.name}let u=e;return i(r)?u=n(u,o(\"short-date\")):s(r)&&(u=a(+u)),u||\"\"}export{w as createLabelFunction,g as formatField};\n"],"names":["e","r","parseWhereClause","t","formatDate","n","convertDateFormatToIntlOptions","o","formatNumber","a","getDomainRange","l","isDateField","i","isNumericField","s","getLabelExpression","u","getSingleFieldArcadeExpression","c","createLabelExpression","f","m","getLogger","p","type","evaluate","d","getAttribute","field","w","symbol","where","expression","repurposeFeature","contextTimeZone","$view","timeZone","$feature","services","toString","error","feature","needsHydrationToEvaluate","replaceAll","slice","get","attributes","name","g","testFeature","domain","codedValues","code","max","min","createLabelFunction","formatField"],"sourceRoot":"webpack:///","x_google_ignoreList":[0]}